#!/bin/bash

# ========================================
# COMANDOS ÃšTEIS - GESTÃƒO DO SISTEMA
# ========================================

DOMAIN="gestor.emmvmfc.com.br"
APP_DIR="/var/www/html/cardapio"

echo "ðŸ”§ COMANDOS ÃšTEIS PARA GESTÃƒO DO SISTEMA"
echo "========================================"
echo ""

echo "ðŸ“Š MONITORAMENTO:"
echo "â€¢ Ver status dos serviÃ§os:"
echo "  systemctl status nginx php8.2-fpm mysql"
echo ""
echo "â€¢ Ver logs em tempo real:"
echo "  tail -f /var/log/gestao-alimentar/monitor.log"
echo "  tail -f $APP_DIR/storage/logs/laravel.log"
echo "  tail -f /var/log/nginx/gestao-alimentar.error.log"
echo ""
echo "â€¢ Ver uso de recursos:"
echo "  htop"
echo "  df -h"
echo "  free -h"
echo ""

echo "ðŸ”„ MANUTENÃ‡ÃƒO:"
echo "â€¢ Reiniciar serviÃ§os:"
echo "  systemctl restart nginx"
echo "  systemctl restart php8.2-fpm"
echo "  systemctl restart mysql"
echo ""
echo "â€¢ Limpar cache Laravel:"
echo "  cd $APP_DIR"
echo "  php artisan cache:clear"
echo "  php artisan config:cache"
echo "  php artisan route:cache"
echo "  php artisan view:cache"
echo ""
echo "â€¢ Backup manual:"
echo "  /usr/local/bin/backup-gestao.sh"
echo ""

echo "ðŸ”’ SSL:"
echo "â€¢ Ver certificados:"
echo "  certbot certificates"
echo ""
echo "â€¢ Renovar SSL:"
echo "  certbot renew"
echo ""
echo "â€¢ Testar renovaÃ§Ã£o:"
echo "  certbot renew --dry-run"
echo ""

echo "ðŸ—„ï¸ BANCO DE DADOS:"
echo "â€¢ Conectar ao MySQL:"
echo "  mysql -u gestao_user -p gestao_alimentar"
echo ""
echo "â€¢ Backup do banco:"
echo "  mysqldump -u gestao_user -p gestao_alimentar > backup.sql"
echo ""
echo "â€¢ Restaurar banco:"
echo "  mysql -u gestao_user -p gestao_alimentar < backup.sql"
echo ""

echo "ðŸ”¥ FIREWALL:"
echo "â€¢ Ver status:"
echo "  ufw status"
echo ""
echo "â€¢ Ver tentativas bloqueadas:"
echo "  fail2ban-client status"
echo "  fail2ban-client status sshd"
echo ""

echo "ðŸ“ ARQUIVOS IMPORTANTES:"
echo "â€¢ ConfiguraÃ§Ã£o Nginx: /etc/nginx/sites-available/gestao-alimentar"
echo "â€¢ ConfiguraÃ§Ã£o PHP: /etc/php/8.2/fpm/conf.d/99-gestao-alimentar.ini"
echo "â€¢ Logs do sistema: /var/log/gestao-alimentar/"
echo "â€¢ Backups: /backup/gestao-alimentar/"
echo ""

echo "ðŸš¨ EMERGÃŠNCIA:"
echo "â€¢ Modo manutenÃ§Ã£o:"
echo "  cd $APP_DIR && php artisan down"
echo "  cd $APP_DIR && php artisan up"
echo ""
echo "â€¢ Verificar erros:"
echo "  nginx -t"
echo "  php -m | grep mysql"
echo "  cd $APP_DIR && php artisan migrate:status"
echo ""
